type: object
required:
  - meta
  - main
properties:
  meta:
    description: Meta-attributes of the API request
    type: object
    required:
      - requestId
      - timestamp
      - callbackUrl
      - timeout
    properties:
      requestId:
        description: Unique identifier of the API request, set by the API client
        type: string
        example: 'msg-8323294'
      timestamp:
        description: Request timestamp, in ISO 8601 format
        type: string
        format: date-time
        example: '2023-10-01T23:59:59Z'
      callbackUrl:
        description: Client's callback URL to be used by the server
        type: string
        format: uri
        example: 'http://aiu1-callback.com'
      timeout: 
        description: The time after which the request, if left unserved by the server, is deemed to have expired
        type: string
        format: date-time
        example: '2023-10-02T23:59:59Z'
  main: 
    description: Main attributes of the API request
    type: object
    required: 
      - farmerId
      - aipId
      - purposeCode
      - dateRange
      - attributesSought
    properties:
      farmerId:
        description: Identifier of the farmer whose data is being sought by the client
        type: string
        pattern: '^\d{11}$'
        example: 12341234123
      aipId:
        description: Identifier of the agricultural information provider (AIP) maintaining the data being sought
        type: string
        example: 'KA'
      purposeCode:
        description: Purpose code indicating the intended use of the sought data 
        type: string
        example: 'CREDIT_KCC'
        enum:
          - CREDIT_KCC
          - CREDIT_OTHER
          - INPUT_SUBSIDY
          - INSURANCE
          - ADVICE
      dateRange:
        description: Upper and lower bounds on the time-instants for which data could be sought
        type: object
        required:
          - from
          - to
        properties:
          from:
            description: Lower bound of the date range
            type: string
            format: date
            example: '2023-10-01'
          to:
            description: Upper bound of the date range
            type: string
            format: date
            example: '2023-10-02'
      attributesSought:
        description: Set of attributes sought by the client
        type: object
        properties:
          profileAttributes:
            description: List of profile attributes that are sought
            type: array
            example: '[NAME, GENDER, CASTE, FARMER_TYPE]'
            items:
              type: string
              enum:
                - NAME
                - GENDER
                - DOB
                - ADDRESS
                - CASTE
                - FARMER_TYPE # Cultivator or owner?
          assetAttributes:
            description: List of asset types and associated metadata that are sought
            type: object
            oneOf: 
              - $ref: '../objects/asset_farm.yaml'
              - $ref: '../objects/asset_livestock.yaml'
                  
              # type: array
              # items:
                  #              properties:
                  #                assetType: 
                  #                  description: Type of asset for which data is sought
                  #                  type: string
                  #                  example: 'FARM'
                  #                  enum:
                  #                    - FARM
                  #                    - LIVESTOCK
                  #                assetAttributes: 
                  #                  description: The list of attributes that can be sought per asset type, some attributes apply only to certain types of assets (e.g., crops sown applies only to farms)
                  #                  type: array
                  #                  example: '[ASSET_COUNT, ASSET_IDENTIFIERS, CROPS_SOWN]'
                  #                  items: 
                  #                    type: string
                  #                    enum:
                  #                      - ASSET_COUNT # flag indicating whether ownership of the asset is revealed or not
                  #                      - ASSET_IDENTIFIERS
                  #                      - ASSET_OWNERSHIP_TYPE # rented or owned
                  #                      - CROPS_SOWN
                  #                      - SOWN_AREA
