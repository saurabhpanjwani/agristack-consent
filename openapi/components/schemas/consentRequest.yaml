type: object
required:
  - meta
  - main
properties:
  meta:
    description: Meta-attributes of the API request
    type: object
    required:
      - requestId
      - timestamp
      - callbackUrl
      - timeout
    properties:
      requestId:
        description: Unique identifier of the API request, set by the API client
        $ref: '../attributes/requestId.yaml'
      timestamp:
        description: Request timestamp, in ISO 8601 format
        $ref: '../attributes/timestamp.yaml'
      callbackUrl:
        description: Client's callback URL to be used by the server
        type: string
        format: uri
        example: 'http://aiu1-callback.com'
      timeout: 
        description: The time after which the request, if left unserved by the server, is deemed to have expired
        type: string
        format: date-time
        example: '2023-10-02T23:59:59Z'
  main: 
    description: Main attributes of the API request
    type: object
    required: 
      - farmerId
      - aipId
      - purposeCode
      - consentUntil
      - attributesSought
    properties:
      farmerId:
        description: Identifier of the farmer whose data is being sought by the client
        type: string
        pattern: '^\d{11}$'
        example: 12341234123
      aipId:
        description: Identifier of the agricultural information provider (AIP) maintaining the data being sought
        type: string
        example: 'KA'
      purposeCode:
        description: Purpose code indicating the intended use of the sought data 
        type: string
        example: 'CREDIT_KCC'
        enum:
          - CREDIT_KCC
          - CREDIT_OTHER
          - INPUT_SUBSIDY
          - INSURANCE
          - ADVICE
      consentUntil:
        description: Date until which permission to fetch data is being sought
        type: string
        format: date
        example: '2024-03-31'
      attributesSought:
        description: Set of attributes sought by the client
        type: object
        properties:
          farmerRegAttributes:
            description: List of farmer registry attributes that are sought
            type: array
            example: '[{NAME, REQUIRED}, {GENDER, OPTIONAL}, {DOB, REQUIRED}, {ADDRESS, OPTIONAL}, {
              CASTE, OPTIONAL}, {FARMER_TYPE, REQUIRED}, {FARM_COUNT, REQUIRED}, {FARM_LIST, REQUIRED}]'
            items:
              type: object
              description: Object that defines each item in the list of sought farmer registry attributes
              required:
                - attributeName
                - requiredOrNot
              properties: 
                attributeName: 
                  description: Name of the sought attribute
                  type: string
                  enum: 
                    - NAME
                    - GENDER
                    - DOB
                    - ADDRESS
                    - CASTE
                    - FARMER_TYPE # Cultivator or owner?
                    - FARM_COUNT
                    - FARM_LIST
                requiredOrNot: 
                  description: Flag indicating whether the attribute is required or not
                  type: string
                  enum:
                    - REQUIRED
                    - OPTIONAL
          cropRegAttributes:
            description: List of crop registry attributes that are sought
            type: array
            example: '[ {CROP_COUNT, {KHARIF, 2023}, OPTIONAL}, {CROP_COUNT, {RABI, 2023}, OPTIONAL}, {CROP_COUNT, 
              {KHARIF, 2022}, OPTIONAL}, {CROP_LIST, {KHARIF, 2023}, OPTIONAL}, {CROP_LIST, {RABI, 2023}, OPTIONAL,
              {CROP_LIST, {KHARIF, 2022}, OPTIONAL} ]' 
            items:
              type: object
              description: Object that defines each item in the list of sought crop registry attributes
              required:
                - attributeName
                - seasonName
                - requiredOrNot
              properties: 
                attributeName: 
                  description: Name of the sought attribute
                  type: string
                  enum: 
                    - CROP_COUNT
                    - CROP_LIST
                seasonName:
                  description: Name of the season for which the attribute's value is sought
                  $ref: '../objects/seasonName.yaml'
                requiredOrNot:
                  description: Flag indicating whether the attribute is required or not
                  type: string
                  enum:
                    - REQUIRED
                    - OPTIONAL
              # type: array
              # items:
                  #              properties:
                  #                assetType: 
                  #                  description: Type of asset for which data is sought
                  #                  type: string
                  #                  example: 'FARM'
                  #                  enum:
                  #                    - FARM
                  #                    - LIVESTOCK
                  #                assetAttributes: 
                  #                  description: The list of attributes that can be sought per asset type, some attributes apply only to certain types of assets (e.g., crops sown applies only to farms)
                  #                  type: array
                  #                  example: '[ASSET_COUNT, ASSET_IDENTIFIERS, CROPS_SOWN]'
                  #                  items: 
                  #                    type: string
                  #                    enum:
                  #                      - ASSET_COUNT # flag indicating whether ownership of the asset is revealed or not
                  #                      - ASSET_IDENTIFIERS
                  #                      - ASSET_OWNERSHIP_TYPE # rented or owned
                  #                      - CROPS_SOWN
                  #                      - SOWN_AREA
